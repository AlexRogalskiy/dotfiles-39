#! /usr/bin/env node

const SunCalc = require('suncalc')

const now = new Date()
const nowTimeString = now.toISOString().slice(-13, -8)
const sunData = SunCalc.getTimes(now, 52.397, 13.077)
const daytimeDuration = sunData.sunset - sunData.sunrise
const daytimeDuration24 = new Date(daytimeDuration).toISOString().slice(-13, -8)
const passedDaytime = (now - sunData.sunrise)
const percentageOfDaytime = Math.trunc((passedDaytime / daytimeDuration) * 100)

const entries = [
	{
		type: 'sunrise',
		time: sunData.sunrise.toISOString().slice(-13, -8),
		icon: 'ðŸŒž',
	},
	{
		type: 'current',
		time: nowTimeString +
			` (${percentageOfDaytime}% of ${daytimeDuration24} h daytime)`,
		icon: 'ðŸ•“',
	},
	{
		type: 'sunset',
		time: sunData.sunset.toISOString().slice(-13, -8),
		icon: 'ðŸŒ‘',
	},
]

const text = entries
	.sort((entryA, entryB) => entryB.time - entryA.time)
	.map(entry => entry.icon + '   ' + entry.time)
	.join('\n')

console.log(text)
